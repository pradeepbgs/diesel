function a(e){switch(e.split(".").pop()?.toLowerCase()){case"js":return"application/javascript";case"css":return"text/css";case"html":return"text/html";case"json":return"application/json";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"svg":return"image/svg+xml";case"gif":return"image/gif";case"woff":return"font/woff";case"woff2":return"font/woff2";default:return"application/octet-stream"}}async function g(e,t,i){if(!t?.length)return;for(let n=0;n<t.length;n++){let r=t[n](...i),o=r instanceof Promise?await r:r;if(o&&e!=="onRequest")return o}}async function d(e,t,i){let n=e.globalMiddlewares;if(n.length)for(let o of n){let s=await o(i);if(s)return s}let r=e.middlewares.get(t);if(r&&r.length)for(let o of r){let s=await o(i);if(s)return s}return null}async function m(e,t,i){for(let n of e){let r=await n(t,i);if(r)return r}}async function w(e,t,i){let n=await u(e,t,i),r=n instanceof Promise?await n:n;if(r)return r}async function u(e,t,i){if(t.endsWith("/"))t=t.slice(0,-1);if(!e.filters.has(t))if(e.filterFunction.length)for(let n of e.filterFunction){let r=await n(i);if(r)return r}else return Response.json({error:"Protected route, authentication required"},{status:401})}async function y(e,t,i,n){if(!e.filters.has(t))if(e.filterFunction.length)for(let r of e.filterFunction){let o=await r(i,n);if(o)return o}else return Response.json({error:"Protected route, authentication required"},{status:401})}async function h(e,t,i){if(e.staticPath){let r=await c(e,i,t);if(r)return r;let o=e.trie.search("*",t.req.method);if(o?.handler)return await o.handler(t)}let n=e.routeNotFoundFunc(t);return n instanceof Promise?await n:n||f(404,`404 Route not found for ${i}`)}function f(e,t){return new Response(JSON.stringify({error:t}),{status:e,headers:{"Content-Type":"application/json"}})}async function c(e,t,i){if(!e.staticPath)return null;let n=`${e.staticPath}${t}`;if(await Bun.file(n).exists()){let o=a(n);return i.file(n,o,200)}return null}export{d as runMiddlewares,g as runHooks,w as runFilter,c as handleStaticFiles,h as handleRouteNotFound,u as handleFilterRequest,y as handleBunFilterRequest,f as generateErrorResponse,m as executeBunMiddlewares};
